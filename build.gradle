apply plugin: 'base'
apply plugin: 'ceylon'

defaultTasks 'compileCeylon'

ext.ceylonRepoDir = System.getProperty("user.home") + "/.ceylon/repo"

compileCeylon {
    module "com.vasileff.ceylon.dart"
    sourceDir file("source")
}

ceylonDoc {
    includeSource = true
    includeNonShared = true
    ignoreMissingDoc = true
    ignoreMissingThrows = true
}

task ceylonTest(type: CeylonTestTask) {
    dependsOn compileCeylon

    report = true
    module "com.vasileff.ceylon.dart"
    test "com.vasileff.ceylon.dart.test"
}

task publish(type: Copy) {
    description 'Copies the compiled modules to the user\'s repository'

    dependsOn "ceylonDoc"
    dependsOn "compileCeylon"

    from ceylonDoc.destinationDir
    from compileCeylon.destinationDir

    into ceylonRepoDir
}

task test {
  dependsOn ceylonTest;
}

wrapper {
    jarFile 'buildSrc/wrapper/gradle-wrapper.jar'
}

